(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{215:function(e,t,a){e.exports=a(404)},220:function(e,t,a){},224:function(e,t,a){},403:function(e,t,a){},404:function(e,t,a){"use strict";a.r(t);var n,r=a(0),i=a.n(r),s=a(26),o=a.n(s),c=(a(220),a(90)),l=a(48),u=a.n(l),d=a(206),f=(a(207),a(39)),v=a(42),h=a(57),D=a(66),p=a(190),y=a.n(p);!function(e){e[e.READONLY=0]="READONLY",e[e.DROPPABLE=1]="DROPPABLE",e[e.DRAGGABLE=2]="DRAGGABLE",e[e.DRAG_AND_DROP=3]="DRAG_AND_DROP"}(n||(n={}));var m=a(184),g=a.n(m),E=(a(224),function(e){return i.a.createElement("div",{className:"tooltip icon"},i.a.createElement(g.a,{label:"warning-icon",primaryColor:"#FF991F",secondaryColor:"#FFFAE5",size:"medium"}),i.a.createElement("div",{className:"tooltipText"},e.items))}),w=function(e){var t,a=e.cell,r=a.row,s=a.col,o=JSON.stringify({row:r,col:s}),l=function(e){return e===n.DRAGGABLE||e===n.DRAG_AND_DROP};return i.a.createElement(D.c,{droppableId:o,isDropDisabled:(t=a.cellType,!(t===n.DROPPABLE||t===n.DRAG_AND_DROP))},(function(e,t){return i.a.createElement("div",{ref:e.innerRef,style:(n=t.isDraggingOver,{height:"100%",background:n?"lightblue":"white"})},a.value.map((function(e,t){return i.a.createElement(D.b,{key:e.id,draggableId:e.id,index:t,isDragDisabled:!l(a.cellType)},(function(t,a){return i.a.createElement("div",Object.assign({ref:t.innerRef},t.draggableProps,t.dragHandleProps,{style:(n=a.isDragging,r=t.draggableProps.style,s=e.color,Object(c.a)({display:"flex",userSelect:"none",padding:"3px",background:n?"lightgreen":s,flexDirection:"row",alignItems:"center",justifyContent:"center"},r))}),e.issue.warnings.length>0?i.a.createElement(E,{items:e.issue.warnings}):null,i.a.createElement("div",{style:{marginLeft:"5px",marginRight:"10px"}},e.title),i.a.createElement("div",{onClick:function(){return t=e.issue.url,void window.open(t,"_blank");var t},style:{cursor:"pointer"}},i.a.createElement(y.a,{label:"open",size:"medium"})));var n,r,s}))})),e.placeholder);var n}))},b=a(24),O=a.n(b),A=function(e,t){for(var a=new Array,n=new Date(e),r=new Date(t);n<=r;)a.push(new Date(n)),n.setDate(n.getDate()+1);return a},k=function(e,t){var a=new Date(e),n=new Date(t),r=O()(a.setDate(a.getDate()-1)),i=O()(n);return Math.trunc(O.a.duration(i.diff(r)).asDays())},C=function(e,t){var a=O()(e),n=O()(t);return a.isSame(n,"year")&&a.isSame(n,"month")&&a.isSame(n,"day")},j=a(107),P=function(){function e(t,a,n,r){Object(v.a)(this,e),this.id=void 0,this.issue=void 0,this.actualPart=void 0,this.totalParts=void 0,this.color=void 0,this.id=Object(j.v4)(),this.issue=t,this.actualPart=a,this.totalParts=n,this.color=r}return Object(h.a)(e,[{key:"isStart",get:function(){return 0===this.actualPart}},{key:"isEnd",get:function(){return this.actualPart===this.totalParts-1}},{key:"isSinglePart",get:function(){return 1===this.totalParts}},{key:"title",get:function(){return this.issue.key}}]),e}(),R=function(e,t){return e.issue.key>t.issue.key?1:e.totalParts<t.totalParts?1:-1},L=a(266),S=function(){function e(t,a,n,r){Object(v.a)(this,e),this.data=new Array,this.users=new Array,this.issues=new Array,this.dates=new Array,this.startDate=void 0,this.endDate=void 0,this.currentDateCol=void 0,this.startDate=n,this.endDate=r,this.currentDateCol=k(n,new Date),this.dates=A(this.startDate,this.endDate),this.users=t,this.issues=a;var i=this.users.length+1,s=k(this.startDate,this.endDate)+1;this.init(i,s)}return Object(h.a)(e,[{key:"createData",value:function(){return this.addDates(),this.addUsers(),this.addIssues(),this.data}},{key:"addDates",value:function(){var e=this;this.dates.forEach((function(t,a){var r=e.createCell(0,a+1,t.toLocaleDateString(),n.READONLY);e.addCell(r)}))}},{key:"addUsers",value:function(){var e=this;this.users.forEach((function(t,a){var r=e.createCell(a+1,0,t.displayName,n.READONLY);e.addCell(r)}))}},{key:"addIssues",value:function(){var e=this,t=new Map,a=new Map;this.issues.forEach((function(n,r){var i=n.startDate?n.startDate:n.created,s=n.dueDate?n.dueDate:e.endDate,o=A(i,s).map((function(e,t,r){var i=a.get(n.key);return i||(i=L({luminosity:"light",format:"rgba",alpha:.8}),a.set(n.key,i)),new P(n,t,r.length,i)})),c=e.dates.findIndex((function(e){return C(e,i)})),l=e.dates.findIndex((function(e){return C(e,s)}));-1!==l&&(l+=1);var u=e.dates.slice(c,l),d=e.users.findIndex((function(e){return e.accountId===n.assignee.accountId}));if(-1===d)throw new Error("No users were found. Without users, issues cannot be displayed");var f=d+1;u.forEach((function(a,n){var r=c+n+1,i=t.get(JSON.stringify({row:f,col:r}));i||(i=[]),i.push(o[n]),t.set(JSON.stringify({row:f,col:r}),i);var s=e.getCellType(r),l=e.createCell(f,r,i.sort(R),s,w);e.addCell(l)}))}))}},{key:"init",value:function(e,t){for(var a=0;a<e;a++){this.data[a]=[];for(var n=0;n<t;n++){var r=this.getCellType(n),i=this.createCell(a,n,[],r,w);this.addCell(i)}}}},{key:"getCellType",value:function(e){return console.log(this.currentDateCol),this.currentDateCol===e?n.DRAG_AND_DROP:this.currentDateCol<e?n.DRAGGABLE:n.READONLY}},{key:"createCell",value:function(e,t,a,n,r){return{row:e,col:t,value:a,DataViewer:r,cellType:n}}},{key:"addCell",value:function(e){this.data[e.row][e.col]=e}}]),e}(),N="".concat("https://bkjira.atlassian.net","/browse/"),x=function e(t,a,n,r,i,s,o){var c=arguments.length>7&&void 0!==arguments[7]?arguments[7]:[];Object(v.a)(this,e),this.key=void 0,this.project=void 0,this.assignee=void 0,this.creator=void 0,this.created=void 0,this.startDate=void 0,this.dueDate=void 0,this.url=void 0,this.warnings=void 0,this.key=t,this.project=a,this.assignee=n,this.creator=r,this.created=i,this.startDate=s,this.dueDate=o,this.url="".concat(N).concat(t),this.warnings=c},T=a(191);var I=a.n(T).a.create({baseURL:"http://localhost:3001"});I.interceptors.request.use((function(e){return e.url=e.url+"?jwt="+window.parent.window.token,e}));var _=function(){function e(){Object(v.a)(this,e),this.defaultQuery={startDate:O()().startOf("isoWeek").toDate(),endDate:O()().endOf("isoWeek").toDate()}}return Object(h.a)(e,[{key:"loadData",value:function(){var e=arguments;return u.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return e.length>0&&void 0!==e[0]?e[0]:this.defaultQuery,t.abrupt("return",F());case 2:case"end":return t.stop()}}),null,this)}},{key:"getData",value:function(e){var t="/users",a="/issues";if(e){e.userName&&(t="".concat(t,"/").concat(e.userName));var n="";e.issue&&(n="".concat(n,"project=").concat(e.issue,"&"));var r=O()(e.startDate).format("YYYY-MM-DD");n="".concat(n,"created>=").concat(r,"&");var i=O()(e.endDate).format("YYYY-MM-DD");(n="".concat(n,"created<=").concat(i,"&")).endsWith("&")&&(n=n.slice(0,-1)),a="".concat(a,"/").concat(n)}return Promise.all([I.get(t),I.get(a)])}}]),e}(),F=function(){var e=[{displayName:"Adam Blasko",accountId:"0",accountType:"atlassian",isActive:!0},{displayName:"Ben Kusicky",accountId:"1",accountType:"atlassian",isActive:!0},{displayName:"Ivan Janovic",accountId:"2",accountType:"atlassian",isActive:!0}],t={key:"JPC",name:"Jira planning calendar"},a=new x("XAM-5147",t,e[0],e[0],new Date,void 0,new Date((new Date).setDate((new Date).getDate()+2)),["Start date is not defined"]),n=new x("XAM-5777",t,e[1],e[1],new Date,new Date,new Date((new Date).setDate((new Date).getDate()+1))),r=O()().startOf("isoWeek").toDate(),i=O()().endOf("isoWeek").toDate();return new S(e,[a,n],r,i).createData()},Y=function(e){return function(t){var a,n;return u.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return t(M()),r.prev=1,a=new _,r.next=5,u.a.awrap(a.loadData(e));case 5:n=r.sent,t(G(n)),r.next=13;break;case 9:r.prev=9,r.t0=r.catch(1),console.log(r.t0),t(B([r.t0]));case 13:case"end":return r.stop()}}),null,null,[[1,9]])}},M=function(){return{type:"FETCH_DATA_REQUEST"}},G=function(e){return{type:"FETCH_DATA_SUCCESS",payload:e}},B=function(e){return{type:"FETCH_DATA_FAILURE",payload:e}},J=function(e,t){return{type:"MOVE",payload:{sourCells:e,destCells:t}}},W=a(36),U=a(117),H=a(415),V=a(414),Q=a(419),q=a(418),z=function(e){var t=function(e){return{width:"25%",flex:"0 1 auto",alignSelf:"auto",marginLeft:0===e?"0":"1%"}},a=e.filterHandler;return i.a.createElement(U.c,{onSubmit:function(e){return a(e)}},(function(e){var a=e.formProps,n=(e.dirty,e.submitting);return i.a.createElement("form",a,i.a.createElement("div",{style:{display:"flex",flexDirection:"row",flexWrap:"nowrap",justifyContent:"flex-start",alignItems:"flex-start",alignContent:"space-between"}},i.a.createElement("div",{style:t(0)},i.a.createElement(q.a,{label:"Start date",name:"startDate",defaultValue:O()().startOf("isoWeek").format("YYYY-MM-DD")},(function(e){var t=e.fieldProps;e.error,e.valid;return i.a.createElement(V.a,t)}))),i.a.createElement("div",{style:t(1)},i.a.createElement(q.a,{label:"End date",name:"endDate",defaultValue:O()().endOf("isoWeek").format("YYYY-MM-DD")},(function(e){var t=e.fieldProps;e.error,e.valid;return i.a.createElement(V.a,t)}))),i.a.createElement("div",{style:t(2)},i.a.createElement(q.a,{label:"User",name:"user",defaultValue:""},(function(e){var t=e.fieldProps;e.error,e.valid;return i.a.createElement(Q.a,t)}))),i.a.createElement("div",{style:t(3)},i.a.createElement(q.a,{label:"Issue",name:"issue",defaultValue:""},(function(e){var t=e.fieldProps;e.error,e.valid;return i.a.createElement(Q.a,t)}))),i.a.createElement("div",{style:{width:"10%",flex:"0 1 auto",alignSelf:"center",marginLeft:"1%",marginTop:"30px"}},i.a.createElement(H.a,{type:"submit",appearance:"primary",isDisabled:n},"Search"))))}))},X=function(e){return e.forEach((function(e){e.style.visibility="hidden"}))},K=a(203),$=a.n(K),Z=a(204),ee=a.n(Z),te=(a(403),function(){var e=Object(W.d)((function(e){return e})),t=Object(W.c)();Object(r.useEffect)((function(){e.isLoading||X(document.querySelectorAll(".FloatingRect")),document.body.addEventListener("mousedown",(function(){X(document.querySelectorAll(".ActiveCell"))}),!0)}),[e.isLoading]),Object(r.useEffect)((function(){t(Y())}),[]);var a=function(a,n){if(a.droppableId===n.droppableId){var r=JSON.parse(a.droppableId);r.row,r.col}else{var i=JSON.parse(a.droppableId),s=JSON.parse(n.droppableId),o=e.data[i.row][i.col].value[a.index],c={row:i.row,col:i.col},l={row:s.row,col:s.col};t(function(e,t,a){return function(n,r){var i=r(),s=Object(f.a)(i.data),o=t.col,c=o+e.totalParts-e.actualPart,l=s[t.row].slice(o,c).map((function(t){return t.value.find((function(t){return t.issue.key===e.issue.key}))})),u=s[t.row].slice(t.col,t.col+l.length);u.forEach((function(t,a){var n=Object.assign({},t);n.value=t.value.filter((function(t){return t.issue.key!==e.issue.key})),u[a]=n}));var d=s[a.row].slice(a.col,a.col+l.length);d.forEach((function(e){var t=Object.assign({},e),a=l.splice(0,1)[0];t.value.push(a),t.value=t.value.sort(R)})),n(J(u,d))}}(o,c,l))}};return i.a.createElement("div",{className:"container"},i.a.createElement("div",null,i.a.createElement(z,{filterHandler:function(e){var a;return u.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:a={userName:e.user,issue:e.issue,startDate:new Date(e.startDate),endDate:new Date(e.endDate)},t(Y(a));case 2:case"end":return n.stop()}}))}})),i.a.createElement($.a,{active:e.isLoading,spinner:i.a.createElement(ee.a,{color:"#0052CC"}),styles:{overlay:function(e){return Object(c.a)({},e,{background:"#D9FFFFFF"})}}},i.a.createElement("div",{className:"calendar"},i.a.createElement(D.a,{onDragEnd:function(e){var t=e.source,n=e.destination;n&&a(t,n)}},i.a.createElement(d.a,{data:e.data})))))});Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var ae=a(31),ne=a(205),re={isLoading:!0,data:[],errors:[]},ie=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:re,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"REORDER":var a=Object(f.a)(e.data);return t.payload.cells.forEach((function(e){a[e.row][e.col]=Object.assign({},e)})),{isLoading:!1,data:a,errors:[]};case"MOVE":var n=Object(f.a)(e.data),r=t.payload.sourCells.concat(t.payload.destCells);return r.forEach((function(e){n[e.row][e.col]=Object.assign({},e)})),{isLoading:!1,data:n,errors:[]};case"FETCH_DATA_REQUEST":return{isLoading:!0,data:Object(f.a)(e.data),errors:[]};case"FETCH_DATA_SUCCESS":return{isLoading:!1,data:Object(f.a)(t.payload),errors:[]};case"FETCH_DATA_FAILURE":return{isLoading:!1,data:[],errors:Object(f.a)(t.payload)};default:return e}},se=Object(ae.d)(ie,Object(ae.a)(ne.a));o.a.render(i.a.createElement(W.a,{store:se},i.a.createElement(te,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[215,1,2]]]);
//# sourceMappingURL=main.087d5b55.chunk.js.map