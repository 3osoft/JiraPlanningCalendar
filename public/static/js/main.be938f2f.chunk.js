(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{214:function(e,t,a){e.exports=a(401)},219:function(e,t,a){},401:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(25),i=a.n(o),s=(a(219),a(89)),c=a(117),l=a(44),u=a.n(l),d=a(206),f=a(34),p=a(31),v=function(){function e(){Object(f.a)(this,e)}return Object(p.a)(e,[{key:"fromJson",value:function(e){return{accountType:e.accountType,accountId:e.accountId,displayName:e.displayName,isActive:e.active}}},{key:"toJson",value:function(e){throw new Error("Method not implemented.")}},{key:"parseArrayFromJson",value:function(e){var t=this,a=new Array;return e.forEach((function(e){var n=t.fromJson(e);n.isActive&&"atlassian"===n.accountType&&a.push(n)})),a}},{key:"parseArrayToJson",value:function(e){throw new Error("Method not implemented.")}}]),e}(),h=function(){function e(){Object(f.a)(this,e)}return Object(p.a)(e,[{key:"fromJson",value:function(e){return{key:e.key,name:e.name}}},{key:"toJson",value:function(e){throw new Error("Method not implemented.")}},{key:"parseArrayFromJson",value:function(e){var t=this,a=new Array;return e.forEach((function(e){a.push(t.fromJson(e))})),a}},{key:"parseArrayToJson",value:function(e){throw new Error("Method not implemented.")}}]),e}(),y=function(){function e(){Object(f.a)(this,e)}return Object(p.a)(e,[{key:"fromJson",value:function(e){var t=new v,a=new h;return{key:e.key,assignee:t.fromJson(e.fields.assignee),creator:t.fromJson(e.fields.creator),created:new Date(e.fields.created),project:a.fromJson(e.fields.project),startDate:new Date(e.fields.customfield_10015),dueDate:new Date(e.fields.duedate)}}},{key:"toJson",value:function(e){throw new Error("Method not implemented.")}},{key:"parseArrayFromJson",value:function(e){var t=this,a=new Array;return e.forEach((function(e){a.push(t.fromJson(e))})),a}},{key:"parseArrayToJson",value:function(e){throw new Error("Method not implemented.")}}]),e}(),m=a(66),g=a(188),w=a.n(g),D=a(190),E=a.n(D),b="".concat("https://bkjira.atlassian.net","/browse/"),O=function(e){var t=e.cell,a=t.row,n=t.col,o=JSON.stringify({row:a,col:n});return r.a.createElement(m.c,{droppableId:o},(function(e,a){return r.a.createElement("div",{ref:e.innerRef,style:(n=a.isDraggingOver,{background:n?"lightblue":"white",padding:"8px"})},t.value.map((function(e,a){return r.a.createElement(m.b,{key:"".concat(t.id,"-").concat(e),draggableId:"".concat(t.id,"-").concat(e),index:a},(function(t,a){return r.a.createElement("div",Object.assign({ref:t.innerRef},t.draggableProps,{style:(n=a.isDragging,o=t.draggableProps.style,Object(s.a)({display:"flex",userSelect:"none",padding:"3px",marginTop:"2px",marginBottom:"2px",background:n?"lightgreen":"white"},o))}),r.a.createElement("div",Object.assign({},t.dragHandleProps,{style:{width:"20px",height:"20px"}}),r.a.createElement(w.a,{label:"drag-handle"})),r.a.createElement("div",{style:{marginLeft:"5px",marginRight:"10px"}},e),r.a.createElement("div",{onClick:function(){return function(e){window.open("".concat(b).concat(e),"_blank")}(e)},style:{width:"20px",height:"20px",cursor:"pointer"}},r.a.createElement(E.a,{label:"open-icon"})));var n,o}))})),e.placeholder);var n}))},k=function(e){var t=e.cell;return r.a.createElement("div",{onMouseDown:function(e){return e.stopPropagation()},onMouseOver:function(e){return e.stopPropagation()}},t.value)},j=a(29),A=a.n(j),x=a(107),C=function(){function e(t,a,n,r){Object(f.a)(this,e),this.data=new Array,this.users=new Array,this.issues=new Array,this.dates=new Array,this.startDate=void 0,this.endDate=void 0,this.startDate=n,this.endDate=r,this.addDates(),this.addUsers(t),this.addIssues(a),this.create()}return Object(p.a)(e,[{key:"calendarData",get:function(){return this.data}}]),Object(p.a)(e,[{key:"addDates",value:function(){for(var e=function(e,t){for(var a=new Array,n=e;n<=t;)a.push(new Date(n).toLocaleDateString()),n.setDate(n.getDate()+1);return a}(new Date(this.startDate),new Date(this.endDate)),t=0;t<e.length;t++){var a=this.createCell(t+1,0,e[t],k);this.dates.push(a)}}},{key:"addUsers",value:function(e){for(var t=0;t<e.length;t++){var a=this.createCell(0,t+1,e[t].displayName);this.users.push(a)}}},{key:"addIssues",value:function(e){for(var t=this,a=new Map,n=function(n){var r=e[n],o=t.dates.findIndex((function(e){return e.value===r.startDate.toLocaleDateString()})),i=t.dates.findIndex((function(e){return e.value===r.dueDate.toLocaleDateString()})),s=t.dates.slice(o,i),c=t.users.find((function(e){return e.value===r.assignee.displayName}));if(!c)throw new Error("No users were found. Without users, issues cannot be displayed");s.forEach((function(e){var n=e.col,o=c.row,i=a.get(JSON.stringify({row:o,col:n}));i||(i=[]),i.push(r.key),a.set(JSON.stringify({row:o,col:n}),i),t.issues.push(t.createCell(n,o,i,O))}))},r=0;r<e.length;r++)n(r)}},{key:"create",value:function(){for(var e=this,t=this.users.length+1,a=function(e,t){var a=A()(e.setDate(e.getDate()-1)),n=A()(t);return Math.trunc(A.a.duration(n.diff(a)).asDays())}(this.startDate,this.endDate)+1,n=0;n<t;n++){this.data[n]=[];for(var r=0;r<a;r++){var o=this.createCell(r,n,[],O);this.addCell(o)}}this.dates.forEach((function(t){e.addCell(t)})),this.users.forEach((function(t){e.addCell(t)})),this.issues.forEach((function(t){e.addCell(t)}))}},{key:"createCell",value:function(e,t,a,n){return{id:Object(x.v4)(),col:e,row:t,value:a,DataViewer:n}}},{key:"addCell",value:function(e){this.data[e.row][e.col]=e}}]),e}(),J=a(191);var S=a.n(J).a.create({baseURL:"http://localhost:3001"});S.interceptors.request.use((function(e){return e.url=e.url+"?jwt="+window.parent.window.token,e}));var T=function(){function e(){Object(f.a)(this,e),this.defaultQuery={startDate:A()().startOf("isoWeek").toDate(),endDate:A()().endOf("isoWeek").toDate()}}return Object(p.a)(e,[{key:"loadData",value:function(){var e,t,a,n,r,o=arguments;return u.a.async((function(i){for(;;)switch(i.prev=i.next){case 0:return e=o.length>0&&void 0!==o[0]?o[0]:this.defaultQuery,i.next=3,u.a.awrap(this.getData(e));case 3:return t=i.sent,a=(new v).parseArrayFromJson(t[0].data),n=(new y).parseArrayFromJson(t[1].data.issues),r=new C(a,n,e.startDate,e.endDate).calendarData,console.log(r),i.abrupt("return",r);case 9:case"end":return i.stop()}}),null,this)}},{key:"getData",value:function(e){var t="/users",a="/issues";if(e){e.userName&&(t="".concat(t,"/").concat(e.userName));var n="";e.issue&&(n="".concat(n,"project=").concat(e.issue,"&"));var r=A()(e.startDate).format("YYYY-MM-DD");n="".concat(n,"created>=").concat(r,"&");var o=A()(e.endDate).format("YYYY-MM-DD");(n="".concat(n,"created<=").concat(o,"&")).endsWith("&")&&(n=n.slice(0,-1)),a="".concat(a,"/").concat(n)}return Promise.all([S.get(t),S.get(a)])}}]),e}(),I=function(e){return function(t){var a,n;return u.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return t(R()),r.prev=1,a=new T,r.next=5,u.a.awrap(a.loadData(e));case 5:n=r.sent,t(F(n)),r.next=13;break;case 9:r.prev=9,r.t0=r.catch(1),console.log(r.t0),t(L([r.t0]));case 13:case"end":return r.stop()}}),null,null,[[1,9]])}},R=function(){return{type:"FETCH_DATA_REQUEST"}},F=function(e){return{type:"FETCH_DATA_SUCCESS",payload:e}},L=function(e){return{type:"FETCH_DATA_FAILURE",payload:e}},M=a(38),Y=a(118),N=a(412),_=a(411),P=a(413),U=a(415),H=function(e){var t=function(e){return{width:"25%",flex:"0 1 auto",alignSelf:"auto",marginLeft:0===e?"0":"1%"}},a=e.filterHandler;return r.a.createElement(Y.c,{onSubmit:function(e){return a(e)}},(function(e){var a=e.formProps,n=(e.dirty,e.submitting);return r.a.createElement("form",a,r.a.createElement("div",{style:{display:"flex",flexDirection:"row",flexWrap:"nowrap",justifyContent:"flex-start",alignItems:"flex-start",alignContent:"space-between"}},r.a.createElement("div",{style:t(0)},r.a.createElement(U.a,{label:"Start date",name:"startDate",defaultValue:A()().startOf("isoWeek").format("YYYY-MM-DD")},(function(e){var t=e.fieldProps;e.error,e.valid;return r.a.createElement(_.a,t)}))),r.a.createElement("div",{style:t(1)},r.a.createElement(U.a,{label:"End date",name:"endDate",defaultValue:A()().endOf("isoWeek").format("YYYY-MM-DD")},(function(e){var t=e.fieldProps;e.error,e.valid;return r.a.createElement(_.a,t)}))),r.a.createElement("div",{style:t(2)},r.a.createElement(U.a,{label:"User",name:"user",defaultValue:""},(function(e){var t=e.fieldProps;e.error,e.valid;return r.a.createElement(P.a,t)}))),r.a.createElement("div",{style:t(3)},r.a.createElement(U.a,{label:"Issue",name:"issue",defaultValue:""},(function(e){var t=e.fieldProps;e.error,e.valid;return r.a.createElement(P.a,t)}))),r.a.createElement("div",{style:{width:"10%",flex:"0 1 auto",alignSelf:"center",marginLeft:"1%",marginTop:"30px"}},r.a.createElement(N.a,{type:"submit",appearance:"primary",isDisabled:n},"Search"))))}))},W=function(e){return e.forEach((function(e){e.style.visibility="hidden"}))},V=a(203),B=a.n(V),Q=a(204),q=a.n(Q),$=function(){var e=Object(M.d)((function(e){return e})),t=Object(M.c)();Object(n.useEffect)((function(){e.isLoading||W(document.querySelectorAll(".FloatingRect")),document.body.addEventListener("mousedown",(function(){W(document.querySelectorAll(".ActiveCell"))}),!0)}),[e.isLoading]),Object(n.useEffect)((function(){t(I())}),[]);var a=function(t,a){return e.data[t][a].value};return r.a.createElement("div",{style:{paddingTop:"1%",paddingBottom:"1%",paddingLeft:"1.5%",paddingRight:"1.5%",backgroundColor:"white"}},r.a.createElement("div",null,r.a.createElement(H,{filterHandler:function(e){var a;return u.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:a={userName:e.user,issue:e.issue,startDate:new Date(e.startDate),endDate:new Date(e.endDate)},t(I(a));case 2:case"end":return n.stop()}}))}})),r.a.createElement(B.a,{active:e.isLoading,spinner:r.a.createElement(q.a,{color:"#0052CC"}),styles:{overlay:function(e){return Object(s.a)({},e,{background:"#D9FFFFFF"})}}},r.a.createElement("div",{style:{height:"600px",marginTop:"1%"}},r.a.createElement(m.a,{onDragEnd:function(e){var n,r,o,i,s,l,u=e.source,d=e.destination;if(d)if(u.droppableId===d.droppableId){var f=JSON.parse(u.droppableId),p=f.row,v=f.col,h=function(e,t,a){var n=Array.from(e),r=n.splice(t,1),o=Object(c.a)(r,1)[0];return n.splice(a,0,o),n}(a(p,v),u.index,d.index);t(function(e,t,a){return{type:"REORDER",payload:{row:e,col:t,data:a}}}(p,v,h))}else{var y=JSON.parse(u.droppableId),m=JSON.parse(d.droppableId),g=y.row,w=y.col,D=m.row,E=m.col,b=function(e,t,a,n){var r=Array.from(e),o=Array.from(t),i=r.splice(a.index,1),s=Object(c.a)(i,1)[0];o.splice(n.index,0,s);var l={};return l[a.droppableId]=r,l[n.droppableId]=o,l}(a(g,w),a(D,E),u,d);t((n=g,r=w,o=b[u.droppableId],i=D,s=E,l=b[d.droppableId],{type:"MOVE",payload:{sourRow:n,sourCol:r,sourData:o,destRow:i,destCol:s,destData:l}}))}}},r.a.createElement(d.a,{style:function(){return{".Spreadsheet td":{whiteSpace:"pre"}}},data:e.data})))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var z=a(32),G=a(205),K=a(59),X={isLoading:!0,data:[],errors:[]},Z=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:X,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"REORDER":var a=Object.assign({},e.data[t.payload.row][t.payload.col]);a.value=t.payload.data;var n=Object(K.a)(e.data);return n[t.payload.row][t.payload.col]=a,{isLoading:!1,data:n,errors:[]};case"MOVE":var r=Object.assign({},e.data[t.payload.sourRow][t.payload.sourCol]);r.value=t.payload.sourData;var o=Object.assign({},e.data[t.payload.destRow][t.payload.destCol]);o.value=t.payload.destData;var i=Object(K.a)(e.data);return i[t.payload.sourRow][t.payload.sourCol]=r,i[t.payload.destRow][t.payload.destCol]=o,{isLoading:!1,data:i,errors:[]};case"FETCH_DATA_REQUEST":return{isLoading:!0,data:Object(K.a)(e.data),errors:[]};case"FETCH_DATA_SUCCESS":return{isLoading:!1,data:Object(K.a)(t.payload)};case"FETCH_DATA_FAILURE":return{isLoading:!1,data:[],errors:Object(K.a)(t.payload)};default:return e}},ee=Object(z.d)(Z,Object(z.a)(G.a));i.a.render(r.a.createElement(M.a,{store:ee},r.a.createElement($,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[214,1,2]]]);
//# sourceMappingURL=main.be938f2f.chunk.js.map