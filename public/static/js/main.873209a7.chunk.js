(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{207:function(e,t,a){e.exports=a(391)},212:function(e,t,a){},220:function(e,t,a){},221:function(e,t,a){},391:function(e,t,a){"use strict";a.r(t);var r=a(0),n=a.n(r),s=a(25),o=a.n(s),i=(a(212),a(113)),c=a(32),u=a.n(c),l=a(198),d="FETCH_DATA",f="REORDER";function h(e){return{type:d,data:e}}var v=a(39),m=(a(220),a(115)),p=a(402),y=a(401),w=a(404),D=a(406),g=(a(221),a(27)),b=a.n(g),E=function(e){var t=e.filterHandler;return n.a.createElement(m.c,{onSubmit:function(e){return t(e)}},(function(e){var t=e.formProps,a=(e.dirty,e.submitting);return n.a.createElement("form",t,n.a.createElement("div",{className:"filter-container"},n.a.createElement("div",{className:"filter-item"},n.a.createElement(D.a,{label:"Start date",name:"startDate",defaultValue:b()().startOf("isoWeek").format("YYYY-MM-DD")},(function(e){var t=e.fieldProps;e.error,e.valid;return n.a.createElement(y.a,t)}))),n.a.createElement("div",{className:"filter-item"},n.a.createElement(D.a,{label:"End date",name:"endDate",defaultValue:b()().endOf("isoWeek").format("YYYY-MM-DD")},(function(e){var t=e.fieldProps;e.error,e.valid;return n.a.createElement(y.a,t)}))),n.a.createElement("div",{className:"filter-item"},n.a.createElement(D.a,{label:"User",name:"user",defaultValue:""},(function(e){var t=e.fieldProps;e.error,e.valid;return n.a.createElement(w.a,t)}))),n.a.createElement("div",{className:"filter-item"},n.a.createElement(D.a,{label:"Issue",name:"issue",defaultValue:""},(function(e){var t=e.fieldProps;e.error,e.valid;return n.a.createElement(w.a,t)}))),n.a.createElement("div",{className:"submit-button"},n.a.createElement(p.a,{type:"submit",appearance:"primary",isDisabled:a},"Search"))))}))},k=a(34),O=a(31),J=a(194);var j=a.n(J).a.create({baseURL:"http://localhost:3001"});function A(e){var t="/users",a="/issues";if(e){e.userName&&(t="".concat(t,"/").concat(e.userName));var r="";e.issue&&(r="".concat(r,"project=").concat(e.issue,"&"));var n=b()(e.startDate).format("YYYY-MM-DD");r="".concat(r,"created>=").concat(n,"&");var s=b()(e.endDate).format("YYYY-MM-DD");(r="".concat(r,"created<=").concat(s,"&")).endsWith("&")&&(r=r.slice(0,-1)),a="".concat(a,"/").concat(r)}return Promise.all([j.get(t),j.get(a)])}j.interceptors.request.use((function(e){return e.url=e.url+"?jwt="+window.parent.window.token,e}));var N=function(){function e(){Object(k.a)(this,e)}return Object(O.a)(e,[{key:"fromJson",value:function(e){return{accountType:e.accountType,accountId:e.accountId,displayName:e.displayName,isActive:e.active}}},{key:"toJson",value:function(e){throw new Error("Method not implemented.")}},{key:"parseArrayFromJson",value:function(e){var t=this,a=new Array;return e.forEach((function(e){var r=t.fromJson(e);r.isActive&&"atlassian"===r.accountType&&a.push(r)})),a}},{key:"parseArrayToJson",value:function(e){throw new Error("Method not implemented.")}}]),e}(),Y=function(){function e(){Object(k.a)(this,e)}return Object(O.a)(e,[{key:"fromJson",value:function(e){return{key:e.key,name:e.name}}},{key:"toJson",value:function(e){throw new Error("Method not implemented.")}},{key:"parseArrayFromJson",value:function(e){var t=this,a=new Array;return e.forEach((function(e){a.push(t.fromJson(e))})),a}},{key:"parseArrayToJson",value:function(e){throw new Error("Method not implemented.")}}]),e}(),M=function(){function e(){Object(k.a)(this,e)}return Object(O.a)(e,[{key:"fromJson",value:function(e){var t=new N,a=new Y;return{key:e.key,assignee:t.fromJson(e.fields.assignee),creator:t.fromJson(e.fields.creator),created:new Date(e.fields.created),project:a.fromJson(e.fields.project)}}},{key:"toJson",value:function(e){throw new Error("Method not implemented.")}},{key:"parseArrayFromJson",value:function(e){var t=this,a=new Array;return e.forEach((function(e){a.push(t.fromJson(e))})),a}},{key:"parseArrayToJson",value:function(e){throw new Error("Method not implemented.")}}]),e}(),x=a(199),I=a(65),C=function(e){var t=e.cell,a=t.row,r=t.col,s=JSON.stringify({row:a,col:r});return n.a.createElement(I.c,{droppableId:s},(function(e,a){return n.a.createElement("div",{ref:e.innerRef,style:(r=a.isDraggingOver,{background:r?"lightblue":"lightgrey",padding:8,width:250})},t.value.map((function(e,t){return n.a.createElement(I.b,{key:e,draggableId:e,index:t},(function(t,a){return n.a.createElement("div",Object.assign({ref:t.innerRef},t.draggableProps,t.dragHandleProps,{style:(r=a.isDragging,s=t.draggableProps.style,Object(x.a)({userSelect:"none",padding:16,margin:"0 0 ".concat(8,"px 0"),background:r?"lightgreen":"grey"},s))}),e);var r,s}))})),e.placeholder);var r}))},S=function(){function e(t,a,r,n){Object(k.a)(this,e),this.data=new Array,this.users=new Array,this.issues=new Array,this.dates=new Array,this.startDate=void 0,this.endDate=void 0,this.addDates(r,n),this.addUsers(t),this.addIssues(a),this.create()}return Object(O.a)(e,[{key:"calendarData",get:function(){return this.data}}]),Object(O.a)(e,[{key:"addDates",value:function(e,t){this.startDate=e,this.endDate=t;for(var a=this.generateDates(e,t),r=0;r<a.length;r++){var n=this.createCell(r+1,0,a[r]);this.dates.push(n)}}},{key:"addUsers",value:function(e){for(var t=0;t<e.length;t++){var a=this.createCell(0,t+1,e[t].displayName);this.users.push(a)}}},{key:"addIssues",value:function(e){var t=this;if(!this.users)throw new Error("Issues can not be displayed without users. You need to set the users.");if(!this.dates)throw new Error("Issues can not be displayed without dates. You need to set rhe dates.");for(var a=new Map,r=function(r){var n=e[r],s=t.dates.find((function(e){return e.value===n.created.toLocaleDateString()})),o=t.users.find((function(e){return e.value===n.assignee.displayName}));if(s&&o){var i=s.col,c=o.row,u=a.get(JSON.stringify({row:c,col:i}));u||(u=[]),u.push(n.key),console.log(u),console.log(a),a.set(JSON.stringify({row:c,col:i}),u);var l=t.createCell(i,c,u,C);t.issues.push(l)}},n=0;n<e.length;n++)r(n)}},{key:"create",value:function(){var e=this,t=1,a=7;if(this.startDate&&this.endDate){var r=b()(this.startDate.setDate(this.startDate.getDate()-1)),n=b()(this.endDate);a=Math.trunc(b.a.duration(n.diff(r)).asDays())+1}this.users&&(t=this.users.length+1);for(var s=0;s<t;s++){for(var o=new Array,i=0;i<a;i++)o.push(this.createCell(i,s,""));this.data.push(o)}this.dates&&this.dates.forEach((function(t){e.addCell(t)})),this.users&&this.users.forEach((function(t){e.addCell(t)})),this.issues&&this.issues.forEach((function(t){e.addCell(t)}))}},{key:"createCell",value:function(e,t,a,r){return{col:e,row:t,value:a,DataViewer:r}}},{key:"addCell",value:function(e){this.data[e.row][e.col]=e}},{key:"generateDates",value:function(e,t){for(var a=new Array,r=e;r<=t;)a.push(new Date(r).toLocaleDateString()),r.setDate(r.getDate()+1);return a}}]),e}(),P=function(){function e(){Object(k.a)(this,e),this.defaultQuery={startDate:b()().startOf("isoWeek").toDate(),endDate:b()().endOf("isoWeek").toDate()}}return Object(O.a)(e,[{key:"loadData",value:function(){var e,t,a,r,n=arguments;return u.a.async((function(s){for(;;)switch(s.prev=s.next){case 0:return e=n.length>0&&void 0!==n[0]?n[0]:this.defaultQuery,s.prev=1,s.next=4,u.a.awrap(A(e));case 4:t=s.sent,s.next=10;break;case 7:s.prev=7,s.t0=s.catch(1),t=null;case 10:return a=t?(new N).parseArrayFromJson(t[0].data):[],r=t?(new M).parseArrayFromJson(t[1].data.issues):[],s.abrupt("return",new S(a,r,e.startDate,e.endDate).calendarData);case 13:case"end":return s.stop()}}),null,this,[[1,7]])}}]),e}(),T=function(){var e=new P,t=Object(v.d)((function(e){return e.data})),a=Object(v.c)(),s=function(t){return u.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,u.a.awrap(e.loadData(t));case 2:return a.abrupt("return",a.sent);case 3:case"end":return a.stop()}}))};Object(r.useEffect)((function(){u.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:a(h([[{row:0,col:0,value:["Raspberry","Apple"],DataViewer:C},{row:0,col:1,value:["Paprika","Onion"],DataViewer:C}],[{row:1,col:0,value:["Cola","Fanta","Sprite"],DataViewer:C}]]));case 2:case"end":return e.stop()}}))}),[]);return n.a.createElement("div",{className:"container"},n.a.createElement("div",null,n.a.createElement(E,{filterHandler:function(e){var t,r;return u.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return t={userName:e.user,issue:e.issue,startDate:new Date(e.startDate),endDate:new Date(e.endDate)},n.next=3,u.a.awrap(s(t));case 3:r=n.sent,a(h(r));case 5:case"end":return n.stop()}}))}})),n.a.createElement("div",{className:"roster-container"},n.a.createElement(I.a,{onDragEnd:function(e){var r=e.source,n=e.destination;if(n&&r.droppableId===n.droppableId){var s=JSON.parse(r.droppableId),o=s.row,c=s.col,u=function(e,t,a){var r=Array.from(e),n=r.splice(t,1),s=Object(i.a)(n,1)[0];return r.splice(a,0,s),r}(function(e,a){return t[e][a].value}(o,c),r.index,n.index);a(function(e,t,a){return{type:f,row:e,col:t,data:a}}(o,c,u))}}},n.a.createElement(l.a,{data:t}))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var V=a(35),F=a(114),R={data:[]};var W=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:R,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case d:return{data:Object(F.a)(t.data)};case f:var a=Object(F.a)(e.data);return a[t.row][t.col].value=t.data,{data:a};default:return e}},H=Object(V.d)(W);o.a.render(n.a.createElement(v.a,{store:H},n.a.createElement(T,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[207,1,2]]]);
//# sourceMappingURL=main.873209a7.chunk.js.map