(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{204:function(e,t,a){e.exports=a(376)},209:function(e,t,a){},375:function(e,t,a){},376:function(e,t,a){"use strict";a.r(t);var n,r=a(0),i=a.n(r),s=a(26),o=a.n(s),c=(a(209),a(88)),l=a(46),u=a.n(l),d=a(195),f=a(196),h=a(38),v=a(41),D=a(47),p=a(65),y=a(179),g=a.n(y);!function(e){e[e.READONLY=0]="READONLY",e[e.DROPPABLE=1]="DROPPABLE",e[e.DRAGGABLE=2]="DRAGGABLE",e[e.DRAG_AND_DROP=3]="DRAG_AND_DROP"}(n||(n={}));var E=a(174),m=function(e){var t,a=e.cell,r=a.row,s=a.col,o=JSON.stringify({row:r,col:s}),l=function(e){return e===n.DRAGGABLE||e===n.DRAG_AND_DROP};return i.a.createElement(p.c,{droppableId:o,isDropDisabled:(t=a.cellType,!(t===n.DROPPABLE||t===n.DRAG_AND_DROP))},(function(e,t){return i.a.createElement("div",{ref:e.innerRef,style:(n=t.isDraggingOver,{background:n?"lightblue":"white",padding:"8px"})},a.value.map((function(e,t){return i.a.createElement(p.b,{key:e.id,draggableId:e.id,index:t,isDragDisabled:!l(a.cellType)},(function(t,a){return i.a.createElement("div",Object.assign({ref:t.innerRef},t.draggableProps,t.dragHandleProps,{style:(n=a.isDragging,r=t.draggableProps.style,Object(c.a)({display:"flex",userSelect:"none",padding:"3px",marginTop:"2px",marginBottom:"2px",background:n?"lightgreen":Object(E.randomcolor)()},r))}),i.a.createElement("div",{style:{marginLeft:"5px",marginRight:"10px"}},e.issue.key),i.a.createElement("div",{onClick:function(){return t=e.issue.url,console.log(t),void window.open(t,"_blank");var t},style:{width:"20px",height:"20px",cursor:"pointer"}},i.a.createElement(g.a,{label:"open"})));var n,r}))})),e.placeholder);var n}))},w=a(25),b=a.n(w),O=function(e,t){for(var a=new Array,n=new Date(e);n<=t;)a.push(new Date(n).toLocaleDateString()),n.setDate(n.getDate()+1);return a},A=a(106),k=function(){function e(t,a,n){Object(v.a)(this,e),this.id=void 0,this.issue=void 0,this.actualPart=void 0,this.totalParts=void 0,this.id=Object(A.v4)(),this.issue=t,this.actualPart=a,this.totalParts=n}return Object(D.a)(e,[{key:"isStart",get:function(){return 0===this.actualPart}},{key:"isEnd",get:function(){return this.actualPart===this.totalParts-1}},{key:"isSinglePart",get:function(){return 1===this.totalParts}}]),e}(),R=function(){function e(t,a,n,r){Object(v.a)(this,e),this.data=new Array,this.users=new Array,this.issues=new Array,this.dates=new Array,this.startDate=void 0,this.endDate=void 0,this.startDate=n,this.endDate=r,this.addDates(),this.addUsers(t),this.addIssues(a),this.create()}return Object(D.a)(e,[{key:"calendarData",get:function(){return this.data}}]),Object(D.a)(e,[{key:"addDates",value:function(){for(var e=O(new Date(this.startDate),new Date(this.endDate)),t=0;t<e.length;t++){var a=this.createCell(0,t+1,e[t],n.READONLY);this.dates.push(a)}}},{key:"addUsers",value:function(e){for(var t=0;t<e.length;t++){var a=this.createCell(t+1,0,e[t].displayName,n.READONLY);this.users.push(a)}}},{key:"addIssues",value:function(e){for(var t=this,a=new Map,r=function(r){var i=e[r],s=O(i.startDate,i.dueDate).map((function(e,t,a){return new k(i,t,a.length)})),o=t.dates.findIndex((function(e){return e.value===i.startDate.toLocaleDateString()})),c=t.dates.findIndex((function(e){return e.value===i.dueDate.toLocaleDateString()}));-1!==c&&(c+=1);var l=t.dates.slice(o,c),u=t.users.find((function(e){return e.value===i.assignee.displayName}));if(!u)throw new Error("No users were found. Without users, issues cannot be displayed");l.forEach((function(e,r){var i,o=e.col,c=u.row,l=a.get(JSON.stringify({row:c,col:o}));l||(l=[]),l.push(s[r]),a.set(JSON.stringify({row:c,col:o}),l);var d=e.value;i=function(e){return b()(e).isSame(b()(),"day")}(d)?n.DRAG_AND_DROP:function(e){return b()(e).isAfter(b()(),"day")}(d)?n.DRAGGABLE:n.READONLY,t.issues.push(t.createCell(c,o,l,i,m))}))},i=0;i<e.length;i++)r(i)}},{key:"create",value:function(){for(var e=this,t=this.users.length+1,a=function(e,t){var a=b()(e.setDate(e.getDate()-1)),n=b()(t);return Math.trunc(b.a.duration(n.diff(a)).asDays())}(this.startDate,this.endDate)+1,r=0;r<t;r++){this.data[r]=[];for(var i=0;i<a;i++){var s=this.createCell(r,i,[],n.READONLY,m);this.addCell(s)}}this.dates.forEach((function(t){e.addCell(t)})),this.users.forEach((function(t){e.addCell(t)})),this.issues.forEach((function(t){e.addCell(t)}))}},{key:"createCell",value:function(e,t,a,n,r){return{row:e,col:t,value:a,DataViewer:r,cellType:n}}},{key:"addCell",value:function(e){this.data[e.row][e.col]=e}}]),e}(),j="".concat("https://bkjira.atlassian.net","/browse/"),C=function e(t,a,n,r,i,s,o){Object(v.a)(this,e),this.key=void 0,this.project=void 0,this.assignee=void 0,this.creator=void 0,this.created=void 0,this.startDate=void 0,this.dueDate=void 0,this.url=void 0,this.key=t,this.project=a,this.assignee=n,this.creator=r,this.created=i,this.startDate=s,this.dueDate=o,this.url="".concat(j).concat(t)},L=function(){function e(){Object(v.a)(this,e),this.defaultQuery={startDate:b()().startOf("isoWeek").toDate(),endDate:b()().endOf("isoWeek").toDate()}}return Object(D.a)(e,[{key:"loadData",value:function(){var e=arguments;return u.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return e.length>0&&void 0!==e[0]?e[0]:this.defaultQuery,t.abrupt("return",P());case 2:case"end":return t.stop()}}),null,this)}}]),e}(),P=function(){var e=[{displayName:"Adam Blasko",accountId:"0",accountType:"atlassian",isActive:!0},{displayName:"Ben Kusicky",accountId:"1",accountType:"atlassian",isActive:!0}],t={key:"JPC",name:"Jira planning calendar"},a=new C("XAM-5147",t,e[0],e[0],new Date,new Date((new Date).setDate((new Date).getDate()-1)),new Date((new Date).setDate((new Date).getDate()+2))),n=new C("XAM-5777",t,e[1],e[1],new Date,new Date,new Date((new Date).setDate((new Date).getDate()+1))),r=b()().startOf("isoWeek").toDate(),i=b()().endOf("isoWeek").toDate();return new R(e,[a,n],r,i).calendarData},x=function(e){return function(t){var a,n;return u.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return t(S()),r.prev=1,a=new L,r.next=5,u.a.awrap(a.loadData(e));case 5:n=r.sent,t(N(n)),r.next=13;break;case 9:r.prev=9,r.t0=r.catch(1),console.log(r.t0),t(_([r.t0]));case 13:case"end":return r.stop()}}),null,null,[[1,9]])}},S=function(){return{type:"FETCH_DATA_REQUEST"}},N=function(e){return{type:"FETCH_DATA_SUCCESS",payload:e}},_=function(e){return{type:"FETCH_DATA_FAILURE",payload:e}},T=function(e,t){return{type:"REORDER",payload:{pos:e,cell:t}}},I=function(e,t){return{type:"MOVE",payload:{sourCells:e,destCells:t}}},F=a(35),Y=a(116),G=a(387),B=a(386),J=a(389),M=a(391),W=function(e){var t=function(e){return{width:"25%",flex:"0 1 auto",alignSelf:"auto",marginLeft:0===e?"0":"1%"}},a=e.filterHandler;return i.a.createElement(Y.c,{onSubmit:function(e){return a(e)}},(function(e){var a=e.formProps,n=(e.dirty,e.submitting);return i.a.createElement("form",a,i.a.createElement("div",{style:{display:"flex",flexDirection:"row",flexWrap:"nowrap",justifyContent:"flex-start",alignItems:"flex-start",alignContent:"space-between"}},i.a.createElement("div",{style:t(0)},i.a.createElement(M.a,{label:"Start date",name:"startDate",defaultValue:b()().startOf("isoWeek").format("YYYY-MM-DD")},(function(e){var t=e.fieldProps;e.error,e.valid;return i.a.createElement(B.a,t)}))),i.a.createElement("div",{style:t(1)},i.a.createElement(M.a,{label:"End date",name:"endDate",defaultValue:b()().endOf("isoWeek").format("YYYY-MM-DD")},(function(e){var t=e.fieldProps;e.error,e.valid;return i.a.createElement(B.a,t)}))),i.a.createElement("div",{style:t(2)},i.a.createElement(M.a,{label:"User",name:"user",defaultValue:""},(function(e){var t=e.fieldProps;e.error,e.valid;return i.a.createElement(J.a,t)}))),i.a.createElement("div",{style:t(3)},i.a.createElement(M.a,{label:"Issue",name:"issue",defaultValue:""},(function(e){var t=e.fieldProps;e.error,e.valid;return i.a.createElement(J.a,t)}))),i.a.createElement("div",{style:{width:"10%",flex:"0 1 auto",alignSelf:"center",marginLeft:"1%",marginTop:"30px"}},i.a.createElement(G.a,{type:"submit",appearance:"primary",isDisabled:n},"Search"))))}))},H=function(e){return e.forEach((function(e){e.style.visibility="hidden"}))},U=a(192),V=a.n(U),Q=a(193),q=a.n(Q),X=(a(375),function(){var e=Object(F.d)((function(e){return e})),t=Object(F.c)();Object(r.useEffect)((function(){e.isLoading||H(document.querySelectorAll(".FloatingRect")),document.body.addEventListener("mousedown",(function(){H(document.querySelectorAll(".ActiveCell"))}),!0)}),[e.isLoading]),Object(r.useEffect)((function(){t(x())}),[]);var a=function(a,n){if(a.droppableId===n.droppableId){var r=JSON.parse(a.droppableId),i={row:r.row,col:r.col};t((d=i,v=a.index,D=n.index,function(e,t){var a=t(),n=Object(h.a)(a.data)[d.row][d.col],r=n.value.splice(v,1),i=Object(f.a)(r,1)[0];n.value.splice(D,0,i),e(T(d,n))}))}else{var s=JSON.parse(a.droppableId),o=JSON.parse(n.droppableId),c=e.data[s.row][s.col].value[a.index],l={row:s.row,col:s.col},u={row:o.row,col:o.col};t(function(e,t,a){return function(n,r){var i=r(),s=Object(h.a)(i.data),o=t.col,c=o+e.totalParts-e.actualPart,l=s[t.row].slice(o,c).map((function(t){return t.value.find((function(t){return t.issue.key===e.issue.key}))})),u=s[t.row].slice(t.col,t.col+l.length);u.forEach((function(t,a){var n=Object.assign({},t);n.value=t.value.filter((function(t){return t.issue.key!==e.issue.key})),u[a]=n}));var d=s[a.row].slice(a.col,a.col+l.length);d.forEach((function(e){var t=Object.assign({},e),a=l.splice(0,1)[0];t.value.push(a)})),n(I(u,d))}}(c,l,u))}var d,v,D};return i.a.createElement("div",{className:"container"},i.a.createElement("div",null,i.a.createElement(W,{filterHandler:function(e){var a;return u.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:a={userName:e.user,issue:e.issue,startDate:new Date(e.startDate),endDate:new Date(e.endDate)},t(x(a));case 2:case"end":return n.stop()}}))}})),i.a.createElement(V.a,{active:e.isLoading,spinner:i.a.createElement(q.a,{color:"#0052CC"}),styles:{overlay:function(e){return Object(c.a)({},e,{background:"#D9FFFFFF"})}}},i.a.createElement("div",{className:"calendar"},i.a.createElement(p.a,{onDragEnd:function(e){var t=e.source,n=e.destination;n&&a(t,n)}},i.a.createElement(d.a,{data:e.data})))))});Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var K=a(30),$=a(194),z={isLoading:!0,data:[],errors:[]},Z=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:z,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"REORDER":var a=t.payload.pos.row,n=t.payload.pos.col,r=Object(h.a)(e.data);return r[a][n]=Object.assign({},t.payload.cell),{isLoading:!1,data:r,errors:[]};case"MOVE":var i=Object(h.a)(e.data),s=t.payload.sourCells.concat(t.payload.destCells);return s.forEach((function(e){i[e.row][e.col]=Object.assign({},e)})),{isLoading:!1,data:i,errors:[]};case"FETCH_DATA_REQUEST":return{isLoading:!0,data:Object(h.a)(e.data),errors:[]};case"FETCH_DATA_SUCCESS":return{isLoading:!1,data:Object(h.a)(t.payload),errors:[]};case"FETCH_DATA_FAILURE":return{isLoading:!1,data:[],errors:Object(h.a)(t.payload)};default:return e}},ee=Object(K.d)(Z,Object(K.a)($.a));o.a.render(i.a.createElement(F.a,{store:ee},i.a.createElement(X,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[204,1,2]]]);
//# sourceMappingURL=main.d7edeaad.chunk.js.map